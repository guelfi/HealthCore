Building...
[14:38:01 INF] User profile is available. Using '/home/guelfi/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.
[14:38:01 INF] Now listening on: http://0.0.0.0:5000
[14:38:01 INF] Application started. Press Ctrl+C to shut down.
[14:38:01 INF] Hosting environment: Development
[14:38:01 INF] Content root path: /mnt/c/Users/SP-MGUELFI/Projetos/HealthCore/src/Api
[14:39:23 INF] Request starting HTTP/1.1 GET http://172.17.158.1:5000/health - null null
[14:39:23 WRN] Failed to determine the https port for redirect.
[14:39:23 INF] Executing endpoint 'Health checks'
[14:39:24 INF] Executed DbCommand (9ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT 1
[14:39:24 INF] Executed endpoint 'Health checks'
[14:39:24 INF] Request finished HTTP/1.1 GET http://172.17.158.1:5000/health - 200 null application/json 1026.6048ms
[14:39:42 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html - null null
[14:39:42 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/index.html - 200 null text/html;charset=utf-8 43.7702ms
[14:39:42 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui.css - null null
[14:39:42 INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
[14:39:42 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui.css - 200 143943 text/css 31.0483ms
[14:39:42 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-bundle.js - null null
[14:39:42 INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
[14:39:42 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 23.4718ms
[14:39:42 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-standalone-preset.js - null null
[14:39:42 INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
[14:39:42 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 12.2661ms
[14:39:42 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json - null null
[14:39:43 INF] No action descriptors found. This may indicate an incorrectly configured application or missing application parts. To learn more, visit https://aka.ms/aspnet/mvc/app-parts
[14:39:43 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/favicon-32x32.png - null null
[14:39:43 INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
[14:39:43 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/favicon-32x32.png - 200 628 image/png 1.6234ms
[14:39:43 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 192.9025ms
[14:50:32 INF] Request starting HTTP/1.1 POST http://172.17.158.1:5000/auth/login - application/json 43
[14:50:32 INF] Executing endpoint 'HTTP: POST /auth/login'
[14:50:32 INF] Tentativa de login para usuário: guelfi
[14:50:32 INF] Tentativa de login para usuário: guelfi
[14:50:32 INF] Executed DbCommand (10ms) [Parameters=[@__username_0='?' (Size = 6)], CommandType='Text', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAt", "u"."IsActive", "u"."PasswordHash", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0 AND "u"."IsActive"
LIMIT 1
[14:50:32 INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
SELECT "r"."Id", "r"."CreatedAt", "r"."ExpiresAt", "r"."IsRevoked", "r"."RevokedAt", "r"."Token", "r"."UserId"
FROM "RefreshTokens" AS "r"
WHERE "r"."UserId" = @__userId_0 AND NOT ("r"."IsRevoked")
[14:50:33 INF] Executed DbCommand (9ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p1='?' (DbType = DateTime)], CommandType='Text', CommandTimeout='30']
UPDATE "RefreshTokens" SET "IsRevoked" = @p0, "RevokedAt" = @p1
WHERE "Id" = @p2
RETURNING 1;
[14:50:33 INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 88), @p5='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
INSERT INTO "RefreshTokens" ("Id", "CreatedAt", "ExpiresAt", "RevokedAt", "Token", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5)
RETURNING "IsRevoked";
[14:50:33 INF] Login bem-sucedido para usuário: guelfi
[14:50:33 INF] Usuário guelfi logado com sucesso
[14:50:33 INF] Setting HTTP status code 200.
[14:50:33 INF] Writing value of type 'LoginResponseDto' as Json.
[14:50:33 INF] Executed endpoint 'HTTP: POST /auth/login'
[14:50:33 INF] Request finished HTTP/1.1 POST http://172.17.158.1:5000/auth/login - 200 null application/json; charset=utf-8 1133.1706ms
[14:50:33 INF] Request starting HTTP/1.1 GET http://172.17.158.1:5000/pacientes - null null
[14:50:33 INF] Executed DbCommand (5ms) [Parameters=[@__tokenId_0='?' (Size = 36)], CommandType='Text', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM "BlacklistedTokens" AS "b"
    WHERE "b"."TokenId" = @__tokenId_0 AND "b"."ExpiresAt" > rtrim(rtrim(strftime('%Y-%m-%d %H:%M:%f', 'now'), '0'), '.'))
[14:50:33 INF] Executing endpoint 'HTTP: GET /pacientes'
[14:50:33 INF] Listando pacientes - Página: 1, Tamanho da página: 10
[14:50:33 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT COUNT(*)
FROM "Pacientes" AS "p"
[14:50:33 INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__p_0='?' (DbType = Int32)], CommandType='Text', CommandTimeout='30']
SELECT "t"."Id", "t"."Nome", "t"."DataNascimento", "t"."Documento", "t"."DataCriacao", "t"."MedicoId", "m"."Nome" AS "MedicoNome", "m"."CRM" AS "MedicoCRM", "m"."Especialidade" AS "MedicoEspecialidade"
FROM (
    SELECT "p"."Id", "p"."DataCriacao", "p"."DataNascimento", "p"."Documento", "p"."MedicoId", "p"."Nome"
    FROM "Pacientes" AS "p"
    ORDER BY "p"."Nome"
    LIMIT @__p_1 OFFSET @__p_0
) AS "t"
LEFT JOIN "Medicos" AS "m" ON "t"."MedicoId" = "m"."Id"
ORDER BY "t"."Nome"
[14:50:33 INF] Listagem de pacientes concluída. Número de pacientes retornados: 10
[14:50:33 INF] Setting HTTP status code 200.
[14:50:33 INF] Writing value of type 'PagedResponseDto`1' as Json.
[14:50:33 INF] Executed endpoint 'HTTP: GET /pacientes'
[14:50:33 INF] Request finished HTTP/1.1 GET http://172.17.158.1:5000/pacientes - 200 null application/json; charset=utf-8 173.2371ms
[14:56:23 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html - null null
[14:56:23 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/index.html - 200 null text/html;charset=utf-8 10.441ms
[14:56:23 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui.css - null null
[14:56:23 INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
[14:56:23 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui.css - 200 143943 text/css 10.9589ms
[14:56:23 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-bundle.js - null null
[14:56:23 INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
[14:56:23 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 15.8636ms
[14:56:23 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-standalone-preset.js - null null
[14:56:23 INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
[14:56:23 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 4.6253ms
[14:56:23 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json - null null
[14:56:23 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/favicon-32x32.png - null null
[14:56:23 INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
[14:56:23 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/favicon-32x32.png - 200 628 image/png 1.9864ms
[14:56:23 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.1029ms
[15:18:48 INF] Request starting HTTP/1.1 GET http://172.17.158.1:5000/health - null null
[15:18:48 INF] Executing endpoint 'Health checks'
[15:18:48 INF] Executed DbCommand (5ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT 1
[15:18:48 INF] Executed endpoint 'Health checks'
[15:18:48 INF] Request finished HTTP/1.1 GET http://172.17.158.1:5000/health - 200 null application/json 166.8565ms
[15:18:55 INF] Request starting HTTP/1.1 POST http://172.17.158.1:5000/api/auth/login - application/json 42
[15:18:55 INF] Request finished HTTP/1.1 POST http://172.17.158.1:5000/api/auth/login - 404 0 null 5.5877ms
[15:18:55 INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://172.17.158.1:5000/api/auth/login, Response status code: 404
[15:19:22 INF] Request starting HTTP/1.1 POST http://172.17.158.1:5000/api/auth/login - application/json 42
[15:19:22 INF] Request finished HTTP/1.1 POST http://172.17.158.1:5000/api/auth/login - 404 0 null 9.6445ms
[15:19:22 INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://172.17.158.1:5000/api/auth/login, Response status code: 404
[15:19:32 INF] Request starting HTTP/1.1 POST http://172.17.158.1:5000/api/auth/login - application/json 42
[15:19:32 INF] Request finished HTTP/1.1 POST http://172.17.158.1:5000/api/auth/login - 404 0 null 2.0358ms
[15:19:32 INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://172.17.158.1:5000/api/auth/login, Response status code: 404
[15:20:21 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/index.html - null null
[15:20:21 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/index.html - 200 null text/html;charset=utf-8 5.8665ms
[15:20:21 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui.css - null null
[15:20:21 INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
[15:20:21 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui.css - 200 143943 text/css 10.0165ms
[15:20:21 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-bundle.js - null null
[15:20:21 INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
[15:20:21 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 22.4431ms
[15:20:21 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-standalone-preset.js - null null
[15:20:21 INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
[15:20:21 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 8.5285ms
[15:20:21 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json - null null
[15:20:21 INF] Request starting HTTP/1.1 GET http://localhost:5000/swagger/favicon-32x32.png - null null
[15:20:21 INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
[15:20:21 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/favicon-32x32.png - 200 628 image/png 8.7958ms
[15:20:21 INF] Request finished HTTP/1.1 GET http://localhost:5000/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 61.5479ms
[15:20:45 INF] Request starting HTTP/1.1 POST http://localhost:5000/auth/login - application/json 52
[15:20:45 INF] CORS policy execution successful.
[15:20:45 INF] Executing endpoint 'HTTP: POST /auth/login'
[15:20:45 INF] Tentativa de login para usuário: guelfi
[15:20:45 INF] Tentativa de login para usuário: guelfi
[15:20:45 INF] Executed DbCommand (6ms) [Parameters=[@__username_0='?' (Size = 6)], CommandType='Text', CommandTimeout='30']
SELECT "u"."Id", "u"."CreatedAt", "u"."IsActive", "u"."PasswordHash", "u"."Role", "u"."Username"
FROM "Users" AS "u"
WHERE "u"."Username" = @__username_0 AND "u"."IsActive"
LIMIT 1
[15:20:45 INF] Executed DbCommand (9ms) [Parameters=[@__userId_0='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
SELECT "r"."Id", "r"."CreatedAt", "r"."ExpiresAt", "r"."IsRevoked", "r"."RevokedAt", "r"."Token", "r"."UserId"
FROM "RefreshTokens" AS "r"
WHERE "r"."UserId" = @__userId_0 AND NOT ("r"."IsRevoked")
[15:20:45 INF] Executed DbCommand (9ms) [Parameters=[@p2='?' (DbType = Guid), @p0='?' (DbType = Boolean), @p1='?' (DbType = DateTime)], CommandType='Text', CommandTimeout='30']
UPDATE "RefreshTokens" SET "IsRevoked" = @p0, "RevokedAt" = @p1
WHERE "Id" = @p2
RETURNING 1;
[15:20:45 INF] Executed DbCommand (12ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = DateTime), @p3='?' (DbType = DateTime), @p4='?' (Size = 88), @p5='?' (DbType = Guid)], CommandType='Text', CommandTimeout='30']
INSERT INTO "RefreshTokens" ("Id", "CreatedAt", "ExpiresAt", "RevokedAt", "Token", "UserId")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5)
RETURNING "IsRevoked";
[15:20:46 INF] Login bem-sucedido para usuário: guelfi
[15:20:46 INF] Usuário guelfi logado com sucesso
[15:20:46 INF] Setting HTTP status code 200.
[15:20:46 INF] Writing value of type 'LoginResponseDto' as Json.
[15:20:46 INF] Executed endpoint 'HTTP: POST /auth/login'
[15:20:46 INF] Request finished HTTP/1.1 POST http://localhost:5000/auth/login - 200 null application/json; charset=utf-8 516.3882ms
[15:20:57 INF] Request starting HTTP/1.1 POST http://172.17.158.1:5000/api/auth/login - application/json 43
[15:20:57 INF] Request finished HTTP/1.1 POST http://172.17.158.1:5000/api/auth/login - 404 0 null 3.1363ms
[15:20:57 INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://172.17.158.1:5000/api/auth/login, Response status code: 404
[15:21:07 INF] Request starting HTTP/1.1 GET http://172.17.158.1:5000/swagger - null null
[15:21:07 INF] Request finished HTTP/1.1 GET http://172.17.158.1:5000/swagger - 301 0 null 5.8121ms
[15:21:19 INF] Request starting HTTP/1.1 POST http://localhost:5000/api/auth/login - application/json 43
[15:21:19 INF] Request finished HTTP/1.1 POST http://localhost:5000/api/auth/login - 404 0 null 2.0122ms
[15:21:19 INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: POST http://localhost:5000/api/auth/login, Response status code: 404
[15:34:20 INF] Request starting HTTP/1.1 GET http://localhost:5000/health - null null
[15:34:20 INF] Executing endpoint 'Health checks'
[15:34:20 INF] Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
SELECT 1
[15:34:20 INF] Executed endpoint 'Health checks'
[15:34:20 INF] Request finished HTTP/1.1 GET http://localhost:5000/health - 200 null application/json 184.2349ms
[15:34:36 INF] Request starting HTTP/1.1 GET http://localhost:5000/api/usuarios - null null
[15:34:36 INF] Request finished HTTP/1.1 GET http://localhost:5000/api/usuarios - 404 0 null 44.4376ms
[15:34:36 INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/api/usuarios, Response status code: 404
[15:34:46 INF] Request starting HTTP/1.1 GET http://localhost:5000/api/usuarios - null null
[15:34:46 INF] Request finished HTTP/1.1 GET http://localhost:5000/api/usuarios - 404 0 null 5.197ms
[15:34:46 INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5000/api/usuarios, Response status code: 404
[16:00:19 INF] Application is shutting down...
